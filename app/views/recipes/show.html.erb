<div class="container mt-4">
  <div class="row">
    <div class="col-lg-12">
      <!-- Recipe Header -->
      <div class="d-flex justify-content-between align-items-start mb-4">
        <div>
          <h1><%= @recipe.title %></h1>
          <p class="text-muted lead"><%= @recipe.description %></p>
          <small class="text-muted">
            Created by <%= @recipe.user.username %> •
            <%= time_ago_in_words(@recipe.created_at) %> ago
          </small>
          <small class="text-muted">
            • Updated
            <%= time_ago_in_words(@recipe.updated_at) %> ago
          </small>
        </div>

        <% if @recipe.user == Current.user %>
          <div class="btn-group">
            <%= link_to "Edit", edit_recipe_path(@recipe), class: "btn btn-outline-primary" %>
            <%= link_to "Delete", @recipe, method: :delete,
                        confirm: "Are you sure?", class: "btn btn-outline-danger" %>
          </div>
        <% end %>
      </div>

      <!-- Recipe Info Cards -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h6 class="card-title">Prep Time</h6>
              <p class="card-text"><%= @recipe.prep_time || 0 %> min</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h6 class="card-title">Cook Time</h6>
              <p class="card-text"><%= @recipe.cook_time || 0 %> min</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h6 class="card-title">Servings</h6>
              <p class="card-text"><%= @recipe.servings %></p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h6 class="card-title">Difficulty</h6>
              <p class="card-text">
                <span class="badge bg-secondary"><%= @recipe.difficulty_level %></span>
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Instructions -->
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0">Instructions</h5>
        </div>
        <div class="card-body">
          <%= simple_format(@recipe.instructions) %>
        </div>
      </div>

      <!-- Ingredients List -->
      <div class="card mb-4">
        <div class="card-header d-flex justify-content-between">
          <h5 class="mb-0">Ingredients</h5>
          <% if @recipe.user == Current.user %>
            <%= link_to "Add Ingredient", edit_recipe_path(@recipe),
                        class: "btn btn-sm btn-outline-primary" %>
          <% end %>
        </div>
        <div class="card-body">
          <% if @recipe.recipe_ingredients.any? %>
            <ul class="list-unstyled">
              <% @recipe.recipe_ingredients.each do |recipe_ingredient| %>
                <li class="mb-2">
                  <div class="d-flex justify-content-between align-items-center">
                    <span>
                      <strong><%= recipe_ingredient.ingredient.name %></strong>
                      <span class="text-muted">- <%= recipe_ingredient.display_quantity %></span>
                      <% if recipe_ingredient.notes.present? %>
                        <small class="text-muted">(<%= recipe_ingredient.notes %>)</small>
                      <% end %>
                    </span>
                    <% if @recipe.user == Current.user %>
                      <%= button_to recipe_recipe_ingredient_path(@recipe, recipe_ingredient),
                                    method: :delete,
                                    class: "btn btn-outline-danger btn-sm",
                                    data: { turbo_confirm: "Remove this ingredient?" } do %>
                        <i class="bi bi-trash"></i>
                      <% end %>
                    <% end %>
                  </div>
                </li>
              <% end %>
            </ul>
          <% else %>
            <p class="text-muted">No ingredients added yet.</p>
            <% if @recipe.user == Current.user %>
              <%= link_to "Add your first ingredient", edit_recipe_path(@recipe), class: "btn btn-primary" %>
            <% end %>
          <% end %>
        </div>
      </div>
      <%= link_to "Back to Recipes", recipes_path, class: "btn btn-outline-secondary" %>
    </div>

  </div>
</div>